
---

# 2) .cursor-rules.md (agent instructions for Cursor)
```md
# Cursor Agent Rules for RAG Engine

You are an expert RAG engineer. Follow these rules strictly while generating code:

1. Always follow SPEC.md as single source of truth.
2. Write idiomatic, testable Python 3.11 code.
3. Implement FastAPI endpoints exactly as in SPEC.
4. Use BackgroundTasks for ingestion processing. Provide a local in-memory job store (sqlite).
5. Integrate with OpenRouter via httpx. Allow `model_id` override per request.
6. For vision calls: enforce strict JSON output. Validate schema before indexing.
7. Use sentence-transformers for embeddings locally. Implement a pluggable embedding loader.
8. Use qdrant-client to upsert vectors. Provide helper to create collection if missing.
9. Provide Dockerfile & docker-compose supporting app + qdrant.
10. Add `.env.example` and README steps.
11. Add minimal unit tests for `/ingest` and composition output.
12. Keep secrets only in env; never hardcode.
13. For any TODO you create, add clear comment and raise appropriate exception if left unimplemented.
14. Make code modular: app/main.py, app/processor.py, app/llm_client.py, app/layout.py, app/vector_store.py, app/models.py
15. Provide good logging and error handling.
